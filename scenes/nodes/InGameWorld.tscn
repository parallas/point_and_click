[gd_scene load_steps=15 format=3 uid="uid://leywsnsi75nu"]

[ext_resource type="Texture2D" uid="uid://bgs7hx85q4kln" path="res://textures/cookie_flashlight.png" id="1_bn13v"]
[ext_resource type="Script" uid="uid://bxyi547r1qtg2" path="res://scripts/PlayerController.cs" id="1_nx5u7"]
[ext_resource type="Script" uid="uid://dg0s252bd10un" path="res://scripts/Flashlight.cs" id="2_nx5u7"]
[ext_resource type="Environment" uid="uid://bbx50g0qsv3jf" path="res://environments/environment_light.tres" id="3_o5l44"]
[ext_resource type="PackedScene" uid="uid://dwoj65lima5sx" path="res://models/room_test.glb" id="4_xc5fd"]
[ext_resource type="Script" uid="uid://wq24jtvwn558" path="res://scripts/SceneCamera.cs" id="5_i5adb"]
[ext_resource type="PackedScene" uid="uid://ccbhv1ml8uk4o" path="res://scenes/nodes/TestInteractable.tscn" id="6_hs3ch"]
[ext_resource type="PackedScene" uid="uid://cn7jisqiafjom" path="res://scenes/nodes/light_switch_double.tscn" id="8_4qer7"]
[ext_resource type="Script" uid="uid://cb62g5vln3p8w" path="res://scripts/interactables/PhysicalInteractionObject.cs" id="8_nx5u7"]
[ext_resource type="Script" uid="uid://cwacnbt5x5lar" path="res://scripts/interactables/components/EnvironmentAmbientRoomLight.cs" id="9_gjtix"]
[ext_resource type="Script" uid="uid://kgtl2utfdra" path="res://scripts/interactables/ScreenSpaceInteractionObject.cs" id="11_xc5fd"]
[ext_resource type="Script" uid="uid://cnh7d2sjnns57" path="res://scripts/interactables/components/CameraChange.cs" id="12_i5adb"]

[sub_resource type="BoxShape3D" id="BoxShape3D_t01cu"]
size = Vector3(0.2, 0.2, 0.1)

[sub_resource type="BoxShape3D" id="BoxShape3D_farti"]
size = Vector3(0.3, 0.2, 0)

[node name="InGameWorld" type="Node3D"]

[node name="Player Controller" type="Node3D" parent="."]
script = ExtResource("1_nx5u7")

[node name="Flashlight" type="SpotLight3D" parent="." node_paths=PackedStringArray("_light")]
light_color = Color(1, 0.966667, 0.9, 1)
light_energy = 5.0
light_projector = ExtResource("1_bn13v")
shadow_enabled = true
spot_range = 15.0
spot_angle = 20.0
script = ExtResource("2_nx5u7")
_light = NodePath(".")
_shiftAmount = 0.1

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = ExtResource("3_o5l44")

[node name="room_test" parent="." instance=ExtResource("4_xc5fd")]

[node name="Camera (Room Left)" type="Camera3D" parent="room_test" node_paths=PackedStringArray("_interactionNodes")]
transform = Transform3D(0.984408, -0.0128826, 0.175427, 0, 0.997315, 0.0732382, -0.175899, -0.0720963, 0.981764, -0.590461, 1.75316, 1.36314)
current = true
fov = 50.0
script = ExtResource("5_i5adb")
_interactionNodes = [NodePath("../TestInteractable"), NodePath("../TestInteractable2"), NodePath("../TestInteractable3")]

[node name="RoomLeft to RoomRight" type="Node" parent="room_test/Camera (Room Left)"]
script = ExtResource("11_xc5fd")
Direction = 4
metadata/_custom_type_script = "uid://kgtl2utfdra"

[node name="CameraChange" type="Node" parent="room_test/Camera (Room Left)/RoomLeft to RoomRight" node_paths=PackedStringArray("TargetCamera")]
script = ExtResource("12_i5adb")
TargetCamera = NodePath("../../../Camera (Room Right)")
metadata/_custom_type_script = "uid://cnh7d2sjnns57"

[node name="Camera (Room Right)" type="Camera3D" parent="room_test" node_paths=PackedStringArray("_interactionNodes")]
transform = Transform3D(0.811778, 0.0427686, -0.582398, 1.32635e-10, 0.997315, 0.0732382, 0.583966, -0.0594531, 0.809598, 0.597, 1.84044, 1.34)
current = true
fov = 50.0
script = ExtResource("5_i5adb")
_interactionNodes = [NodePath("../Light Switch/GoToLightSwitch")]

[node name="RoomRight to RoomLeft" type="Node" parent="room_test/Camera (Room Right)"]
script = ExtResource("11_xc5fd")
Direction = 3
metadata/_custom_type_script = "uid://kgtl2utfdra"

[node name="CameraChange" type="Node" parent="room_test/Camera (Room Right)/RoomRight to RoomLeft" node_paths=PackedStringArray("TargetCamera")]
script = ExtResource("12_i5adb")
TargetCamera = NodePath("../../../Camera (Room Left)")
metadata/_custom_type_script = "uid://cnh7d2sjnns57"

[node name="Room Light" type="OmniLight3D" parent="room_test"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 2.67818, 0)
light_energy = 2.0
light_size = 0.075
shadow_enabled = true
omni_range = 4.0
omni_attenuation = 1.5

[node name="Candle Light" type="OmniLight3D" parent="room_test"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, -0.91711, 1.05292, -1.11558)
light_color = Color(0.91, 0.633967, 0.4368, 1)
light_energy = 0.25
light_size = 0.075
shadow_enabled = true
omni_range = 2.0
omni_attenuation = 1.5

[node name="TestInteractable" parent="room_test" instance=ExtResource("6_hs3ch")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.898694, 1.71406, -1.37243)

[node name="TestInteractable2" parent="room_test" instance=ExtResource("6_hs3ch")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.476692, 2.11116, -1.37243)

[node name="TestInteractable3" parent="room_test" instance=ExtResource("6_hs3ch")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.53189, 1.46541, -1.58328)

[node name="Light Switch" type="Node3D" parent="room_test"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, 2.50071, 1.64657, 0.0486417)

[node name="Camera (Light Switch)" type="Camera3D" parent="room_test/Light Switch" node_paths=PackedStringArray("_interactionNodes")]
transform = Transform3D(1, 0, 0, 0, 0.967188, 0.254062, 0, -0.254062, 0.967188, 0.00478012, 0.13413, 0.49414)
fov = 50.0
script = ExtResource("5_i5adb")
_interactionNodes = [NodePath("../light_switch_double"), NodePath("../ToRoomFromLightSwitch")]
ShiftAmount = 0.025
FlashlightBrightness = 1.0

[node name="light_switch_double" parent="room_test/Light Switch" instance=ExtResource("8_4qer7")]

[node name="EnvironmentAmbientRoomLight" type="Node" parent="room_test/Light Switch/light_switch_double" node_paths=PackedStringArray("_lightSource", "_worldEnvironment")]
script = ExtResource("9_gjtix")
_lightSource = NodePath("../../../Room Light")
_worldEnvironment = NodePath("../../../../WorldEnvironment")
metadata/_custom_type_script = "uid://cwacnbt5x5lar"

[node name="Candle Light2" type="OmniLight3D" parent="room_test/Light Switch/light_switch_double"]
transform = Transform3D(-4.37114e-08, -1, -4.37114e-08, 0, -4.37114e-08, 1, -1, 4.37114e-08, 1.91069e-15, 7.45058e-09, 0, 0.454108)
light_color = Color(0.91, 0.633967, 0.4368, 1)
light_energy = 0.05
light_size = 0.075
shadow_enabled = true
omni_range = 1.0
omni_attenuation = 0.1

[node name="GoToLightSwitch" type="StaticBody3D" parent="room_test/Light Switch"]

[node name="PhysicalInteractionObject" type="Node" parent="room_test/Light Switch/GoToLightSwitch"]
script = ExtResource("8_nx5u7")
metadata/_custom_type_script = "uid://cb62g5vln3p8w"

[node name="CameraChange" type="Node" parent="room_test/Light Switch/GoToLightSwitch/PhysicalInteractionObject" node_paths=PackedStringArray("TargetCamera")]
script = ExtResource("12_i5adb")
TargetCamera = NodePath("../../../Camera (Light Switch)")
metadata/_custom_type_script = "uid://cnh7d2sjnns57"

[node name="CollisionShape3D" type="CollisionShape3D" parent="room_test/Light Switch/GoToLightSwitch"]
shape = SubResource("BoxShape3D_t01cu")

[node name="ToRoomFromLightSwitch" type="StaticBody3D" parent="room_test/Light Switch"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.00465021, -0.053, 0.34819)

[node name="ScreenSpaceInteractionObject" type="Node" parent="room_test/Light Switch/ToRoomFromLightSwitch"]
script = ExtResource("11_xc5fd")
Direction = 2
metadata/_custom_type_script = "uid://kgtl2utfdra"

[node name="CameraChange" type="Node" parent="room_test/Light Switch/ToRoomFromLightSwitch/ScreenSpaceInteractionObject" node_paths=PackedStringArray("TargetCamera")]
script = ExtResource("12_i5adb")
TargetCamera = NodePath("../../../../Camera (Room Right)")
metadata/_custom_type_script = "uid://cnh7d2sjnns57"

[node name="CollisionShape3D" type="CollisionShape3D" parent="room_test/Light Switch/ToRoomFromLightSwitch"]
shape = SubResource("BoxShape3D_farti")

[node name="CSGBox3D" type="CSGBox3D" parent="room_test/Light Switch/ToRoomFromLightSwitch"]
visible = false
size = Vector3(0.3, 0.2, 0.001)

[connection signal="OnLeftChange" from="room_test/Light Switch/light_switch_double" to="Flashlight" method="set_visible"]
[connection signal="OnRightChange" from="room_test/Light Switch/light_switch_double" to="room_test/Light Switch/light_switch_double/EnvironmentAmbientRoomLight" method="SetState"]
